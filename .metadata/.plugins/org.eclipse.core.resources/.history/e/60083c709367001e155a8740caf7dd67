package XML;

import java.util.ArrayList;
import java.util.List;

import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;

import org.xml.sax.Attributes;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;

public class SAXimplementation {

	public static void main(String[] args) {
		try {
			SAXParserFactory factory = SAXParserFactory.newInstance();
			SAXParser saxParser = factory.newSAXParser();
			MyHandler handler = new MyHandler();
			saxParser.parse("PersonaSerie.xml", handler);

			List<Persona> personas = handler.getPersonas();
			for (Persona persona : personas) {
				System.out.println("Persona: " + persona.getNombre());
				System.out.println("Serie Favorita: " + persona.getSerieFavorita());
			}
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}

class Persona {
	private String nombre;
	private String serieFavorita;

	public String getNombre() {
		return nombre;
	}

	public void setNombre(String nombre) {
		this.nombre = nombre;
	}

	public String getSerieFavorita() {
		return serieFavorita;
	}

	public void setSerieFavorita(String serieFavorita) {
		this.serieFavorita = serieFavorita;
	}
}

class MyHandler extends DefaultHandler {
	private List<Persona> personas = new ArrayList<>();
	private Persona persona;
	private String currentElement;

	public List<Persona> getPersonas() {
		return personas;
	}

	@Override
	public void startElement(String uri, String localName, String qName, Attributes attributes) throws SAXException {
		currentElement = qName;
		if ("persona".equals(qName)) {
			persona = new Persona();
		}
	}

	@Override
	public void characters(char[] ch, int start, int length) throws SAXException {
		String value = new String(ch, start, length).trim();
		if (!value.isEmpty()) {
			if ("nombre".equals(currentElement)) {
				persona.setNombre(value);
			} else if ("serie_favorita".equals(currentElement)) {
				persona.setSerieFavorita(value);
			}
		}
	}

	@Override
	public void endElement(String uri, String localName, String qName) throws SAXException {
		if ("persona".equals(qName)) {
			personas.add(persona);
		}
		currentElement = "";
	}
}
